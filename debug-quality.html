<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Quality String</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-info { font-family: monospace; background: #f5f5f5; padding: 10px; margin: 5px 0; border-radius: 3px; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
</head>
<body>
    <h1>Debug Quality String Issue</h1>
    <button onclick="testQualityString()">Test Quality String</button>
    <div id="results"></div>

    <script src="script.js"></script>
    <script>
        function testQualityString() {
            const resultsDiv = document.getElementById('results');
            
            try {
                const accompanist = new MusicalAccompanist();
                
                // Test the exact flow for V7
                console.log('Testing V7 parsing flow...');
                
                // Step 1: Check what getRomanNumeralChord returns
                const chord = accompanist.getRomanNumeralChord('V7');
                
                resultsDiv.innerHTML = `
                    <h3>V7 Analysis:</h3>
                    <div class="debug-info">
                        Full chord object: ${JSON.stringify(chord, null, 2)}
                    </div>
                    <div class="debug-info">
                        Notes array: [${chord ? chord.notes.join(', ') : 'null'}]
                    </div>
                    <div class="debug-info">
                        Notes count: ${chord ? chord.notes.length : 0}
                    </div>
                    <div class="debug-info">
                        Chord quality: "${chord ? chord.chordQuality : 'null'}"
                    </div>
                `;
                
                // Step 2: Test the buildChordFromRoot directly with known parameters
                console.log('Testing buildChordFromRoot directly...');
                const directTest = accompanist.buildChordFromRoot(7, 'dominant7', 'TestV7');
                
                resultsDiv.innerHTML += `
                    <h3>Direct buildChordFromRoot Test:</h3>
                    <div class="debug-info">
                        Direct test result: ${JSON.stringify(directTest, null, 2)}
                    </div>
                `;
                
                // Step 3: Test string comparison
                const testQuality = 'dominant7';
                const result = testQuality === 'dominant7' ? 'MATCH' : 'NO MATCH';
                
                resultsDiv.innerHTML += `
                    <h3>String Comparison Test:</h3>
                    <div class="debug-info">
                        'dominant7' === 'dominant7': ${result}
                    </div>
                `;
                
            } catch (error) {
                resultsDiv.innerHTML = `<div style="color: red;">Error: ${error.message}</div>`;
                console.error('Test error:', error);
            }
        }
    </script>
</body>
</html>
